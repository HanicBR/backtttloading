<!DOCTYPE html> 
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <title>Backstabber Brasil - Loading</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />

  <!-- Fonts -->
  <link rel="preconnect" href="https://fonts.gstatic.com">
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&family=Teko:wght@400;600;700&display=swap" rel="stylesheet">

  <style>
    /* =========================================================
   CONFIG VISUAL
   ========================================================= */
:root{
  --bg: #e9edf3;

  /* CARDS MAIS TRANSPARENTES */
  --glass: rgba(255,255,255,0.50);
  --glass-strong: rgba(255,255,255,0.58);
  --glass-border: rgba(0,0,0,0.05);

  --text: #0b1220;
  --muted: #475569;

  --red: #BE1B3C;
  --red-soft: rgba(190,27,60,0.10);
  --blue: #2563eb;
  --green: #16a34a;

  --radius-lg: 28px;
  --radius-md: 20px;
  --radius-sm: 14px;

  --pad-x: clamp(12px, 2vw, 28px);
  --pad-y: clamp(10px, 1.6vw, 24px);

  --fs-xs: clamp(10px, 0.9vw, 12px);
  --fs-sm: clamp(12px, 1vw, 14px);
  --fs-md: clamp(14px, 1.15vw, 16px);
  --fs-lg: clamp(16px, 1.4vw, 18px);
  --fs-xl: clamp(20px, 2vw, 26px);
  --fs-2xl: clamp(26px, 3vw, 36px);

  --shadow-soft: 0 10px 28px rgba(0,0,0,0.08);
  --shadow-deep: 0 18px 50px rgba(0,0,0,0.12);

  --ui-scale: 1;
}

* { box-sizing: border-box; margin:0; padding:0; }

/* >>> FIX PRINCIPAL PARA 16:10 / CEF <<< */
html, body {
  width: 100%;
  height: 100%;
  min-height: 100vh;
  margin: 0;
  overflow: hidden;         /* padrão: sem scroll */
  background: var(--bg);    /* fallback NÃO preto */
}

body {
  font-family: Inter, system-ui, sans-serif;
  background: transparent;
  color: var(--text);
  position: relative;
}

/* =========================================================
   BACKGROUND (cover total, sem faixa em 16:10)
   ========================================================= */
.bg-layer{
  position: fixed;
  top: -50%;
  left: -50%;
  width: 200%;
  height: 200%;
  z-index: 0;
  overflow: hidden;
  pointer-events: none;
  background: var(--bg);
}

.bg-layer img{
  position: absolute;
  top: 0; left: 0; right: 0; bottom: 0;
  margin: auto;
  min-width: 50%;
  min-height: 50%;
  transform: scale(1.05);
}

/* =========================================================
   LAYOUT
   ========================================================= */
.wrap {
  position: relative;
  z-index: 1;
  width: 100%;
  height: 100vh;
  min-height: 100vh;
  padding: var(--pad-y) var(--pad-x);
  display: grid;
  grid-template-rows: auto 1fr auto;
  gap: clamp(10px, 1.4vw, 18px);
  transform: scale(var(--ui-scale));
  transform-origin: center center;
}

.container {
  width: 100%;
  height: 100%;
  max-width: 1500px;
  margin: 0 auto;
  margin-top: 5%;
  display: grid;
  grid-template-rows: auto 1fr auto;
  gap: inherit;
  min-height: 0;
}

/* TOP GRID: 3 cards em cima, VIP embaixo crescendo por colunas */
.top-grid {
  display:grid;
  grid-template-columns: 1.25fr 1fr 1fr;
  grid-auto-rows: auto;
  gap: clamp(10px, 1.4vw, 18px);
  align-items: stretch;
}

/* primeira linha */
.card-ttt {
  grid-column: 1;
  grid-row: 1;
}
.card-vipclub {
  grid-column: 2;
  grid-row: 1;
}
.card-rules {
  grid-column: 3;
  grid-row: 1;
}

/* VIP na segunda linha – largura controlada via JS (grid-column) */
.card-vips {
  grid-row: 2;
  grid-column: 2 / span 1; /* padrão: só coluna do meio (4 VIPs) */
  justify-self: stretch;
  width: 100%;
  max-width: 100%;
}

.glass-card{
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg);
  padding: clamp(12px, 1.4vw, 18px);
  box-shadow:
    var(--shadow-soft),
    inset 0 1px 0 rgba(255,255,255,0.45);
  min-height: clamp(145px, 18vh, 220px);
  overflow: hidden;
  display:flex;
  flex-direction: column;
  gap: 8px;
  position: relative;
}

/* brilho interno mais suave (não afeta texto) */
.glass-card::after{
  content:"";
  position:absolute;
  inset:-30%;
  background: radial-gradient(circle at 30% 10%, rgba(255,255,255,0.30), transparent 50%);
  opacity: 0.15;
  pointer-events:none;
}

.card-scroll{
  overflow:auto;
  padding-right: 4px;
  scrollbar-width: thin;
}

/* =========================================================
   TTT CARD
   ========================================================= */
.ttt-header {
  display:flex; align-items:center; gap:10px;
  font-weight:800; font-size: var(--fs-xl);
}
.ttt-badge{
  background: rgba(239,68,68,0.80);
  color:white;
  font-weight:900;
  letter-spacing:0.10em;
  padding:5px 8px;
  border-radius: 7px;
  font-size: var(--fs-sm);
  box-shadow: 0 6px 16px rgba(239,68,68,0.30);
}
.ttt-subtitle{
  font-size: var(--fs-sm);
  font-weight:900; letter-spacing:0.10em;
  text-transform:uppercase; color:#111827;
}
.ttt-text{
  font-size: var(--fs-md);
  color:var(--text);
  line-height:1.42;
}
.role-line{ margin-top:7px; }
.dot{
  display:inline-block; width:9px; height:9px;
  border-radius:999px; margin-right:7px;
  transform: translateY(1px);
  box-shadow: inset 0 0 0 1px rgba(0,0,0,0.12);
  opacity: 0.9;
}
.dot-red{ background:#ef4444; }
.dot-green{ background:#22c55e; }
.dot-blue{ background:#3b82f6; }

/* =========================================================
   VIP CLUB CARD
   ========================================================= */
.vip-club-card{
  justify-content:center;
  text-align:center;
  background:
    radial-gradient(circle at top, var(--red-soft), transparent 65%),
    var(--glass);
}
.vip-club-title{
  font-weight:900;
  font-size: var(--fs-xl);
  letter-spacing:0.12em; text-transform:uppercase;
  margin-bottom: 4px;
}
.vip-club-text{
  font-size: var(--fs-lg);
  color:#111827; line-height:1.38;
  padding: 0 8px;
}

/* =========================================================
   VIPS CARD (CENTRAL)
   ========================================================= */
.vip-box{
  background: var(--glass-strong);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg);
  padding: clamp(10px, 1.2vw, 14px);
  min-height: clamp(160px, 20vh, 240px);
  max-height: 100%;
  display:flex; flex-direction:column; gap:10px;
  box-shadow: var(--shadow-soft);
  overflow: hidden;
  position: relative;
}
.vip-head{
  display:flex; align-items:center; justify-content:center; gap:8px;
  flex-shrink:0;
}
.vip-badge{
  font-size: var(--fs-xs);
  font-weight:900;
  letter-spacing:.18em;
  text-transform:uppercase;
  color:#fff;
  background: rgba(190,27,60,0.85);
  padding: 4px 8px;
  border-radius: 999px;
  box-shadow: 0 6px 14px rgba(190,27,60,0.28);
}
.vip-title{
  font-size: var(--fs-sm);
  font-weight:900;
  letter-spacing:.12em;
  text-transform:uppercase;
  color:#111827;
}

/* VIPs em colunas com no máximo 4 por coluna */
.vip-list{
  display:grid;
  grid-template-rows: repeat(4, auto); /* até 4 VIPs por coluna */
  grid-auto-flow: column;              /* preenche a coluna primeiro, depois abre outra */
  row-gap: 8px;
  column-gap: 8px;
  padding-right: 4px;
  overflow:auto;
}

.vip-card{
  display:flex; align-items:center; gap:10px;
  padding:8px 10px;
  border-radius: var(--radius-sm);
  border:1px solid rgba(0,0,0,0.06);
  flex-shrink:0;
  background: rgba(255,255,255,0.68);
}
.vip-avatar{
  width: clamp(36px, 4vw, 50px);
  height: clamp(36px, 4vw, 50px);
  border-radius:999px; object-fit:cover;
  border:2px solid rgba(190,27,60,0.9);
  flex-shrink:0;
  background: rgba(255,255,255,0.9);
}
.vip-name{
  font-weight:900; font-size: clamp(14px, 1.8vw, 18px); line-height:1;
}
.vip-id{
  font-size: var(--fs-xs); color:var(--muted);
  margin-top: 2px;
}

.rainbow-text{
  background: linear-gradient(90deg,#ff0000,#ff7f00,#ffff00,#00ff00,#00ffff,#0000ff,#8b00ff,#ff0000);
  background-size: 400% 100%;
  -webkit-background-clip:text; background-clip:text;
  color:transparent;
  animation: rainbowMove 4s linear infinite;
  filter: drop-shadow(0 1px 0 rgba(0,0,0,0.15));
}
@keyframes rainbowMove {
  0%{ background-position:0% 50%; }
  100%{ background-position:400% 50%; }
}

/* =========================================================
   RULES CARD
   ========================================================= */
.rules-title{
  font-weight:900; font-size: var(--fs-lg);
  text-align:center;
}
.rules-list{
  display:flex; flex-direction:column;
  gap: clamp(6px, 1vh, 10px);
  font-size: var(--fs-lg); color:#111827;
}
.rule-item{ display:flex; gap:12px; align-items:flex-start; }
.rule-num{
  min-width: clamp(34px, 3.5vw, 44px);
  min-height: clamp(34px, 3.5vw, 44px);
  border-radius:10px;
  display:flex; align-items:center; justify-content:center;
  font-weight:900; font-size: clamp(16px, 2vw, 22px);
  color:#1d4ed8;
  background: rgba(29,78,216,0.07);
  border: 1px solid rgba(29,78,216,0.10);
  flex-shrink: 0;
}

/* =========================================================
   BOTTOM LOADING BAR
   ========================================================= */
.loading-bar{
  background: var(--glass-strong);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-lg);
  padding: clamp(10px, 1.2vw, 14px) clamp(12px, 1.4vw, 16px);
  width: 100%;
  box-shadow: var(--shadow-deep);
  display:flex; flex-direction:column; gap:8px;
}

.loading-top{
  display:flex; align-items:flex-end; justify-content:space-between; gap:12px;
  flex-wrap: wrap;
}
.server-name{
  font-family: Teko, Inter, sans-serif;
  font-size: var(--fs-2xl);
  letter-spacing:0.18em; text-transform:uppercase;
  color:#111827;
}
.server-sub{
  font-size: var(--fs-xs);
  color:var(--muted);
  letter-spacing:0.12em; text-transform:uppercase;
}

.progress-bg{
  width:100%; height: clamp(10px, 1.2vw, 14px);
  border-radius:999px;
  background: rgba(15,23,42,0.07);
  overflow:hidden;
  border:1px solid rgba(0,0,0,0.06);
}
.progress-fill{
  height:100%; width:0%;
  border-radius:999px;
  background: linear-gradient(90deg, rgba(190,27,60,0.92), rgba(251,113,133,0.92));
  transition: width .2s ease;
  box-shadow: 0 0 10px rgba(190,27,60,0.45);
}

.loading-bottom{
  display:flex; align-items:center; justify-content:space-between; gap:10px;
  flex-wrap: wrap;
  font-size: var(--fs-sm);
  color:#111827;
}
.percent{
  font-weight:900;
  font-size: clamp(16px, 2vw, 20px);
  color:#111827;
  margin-left:auto;
}
.status{
  font-size: var(--fs-md);
  color:#0f172a;
  max-width: 75ch;
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
}
.file{
  font-size: var(--fs-xs); color:var(--muted);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  max-width: 60vw;
}
.mini-info{
  text-align:right; font-size:var(--fs-xs); color:var(--muted);
  display:flex; flex-direction:column; gap:2px;
}

@media (prefers-reduced-motion: reduce){
  * { animation: none !important; transition: none !important; }
}

.text-outline {
  -webkit-text-stroke: 0.7px rgba(255,255,255,0.9);
  text-shadow:
    -0.7px -0.7px 0 rgba(255,255,255,0.9),
     0.7px -0.7px 0 rgba(255,255,255,0.9),
    -0.7px  0.7px 0 rgba(255,255,255,0.9),
     0.7px  0.7px 0 rgba(255,255,255,0.9);
}

/* área inferior: loading-bar + créditos separados */
.bottom-area{
  display: flex;
  flex-direction: column;
  gap: 6px;
}

/* cardzinho separado de créditos */
.credits-card{
  width: fit-content;
  max-width: 90%;
  background: var(--glass);
  border: 1px solid var(--glass-border);
  border-radius: var(--radius-sm);
  padding: 6px 10px;
  font-size: var(--fs-xs);
  color: var(--muted);
  box-shadow: var(--shadow-soft);
  text-align: right;
  margin-left: auto;
}

/* =========================================================
   RESPONSIVIDADE POR LARGURA
   (mantendo o grid geral)
   ========================================================= */

/* 1280px: compacta um pouco */
@media (max-width: 1280px){
  .container{
    max-width: 1200px;
    margin-top: 3%;
  }

  .wrap{
    padding: 10px var(--pad-x);
  }

  .glass-card,
  .vip-box,
  .loading-bar{
    border-radius: 22px;
    padding: 10px 14px;
  }

  .rules-list{
    font-size: var(--fs-md);
  }
}

/* 1024px: fontes menores e alturas reduzidas */
@media (max-width: 1024px){
  :root{
    --fs-xs: 10px;
    --fs-sm: 11px;
    --fs-md: 12px;
    --fs-lg: 13px;
    --fs-xl: 18px;
    --fs-2xl: 22px;
  }

  .container{
    max-width: 1150px;
    margin-top: 1%;
  }

  .glass-card{
    min-height: 130px;
  }

  .vip-box{
    min-height: 140px;
  }

  .server-name{
    letter-spacing: 0.14em;
  }
}

/* 820px: ainda mesmo grid, tudo mais miudinho */
@media (max-width: 820px){
  .container{
    max-width: 1100px;
    margin-top: 0;
  }

  .wrap{
    padding: 8px 10px;
    gap: 8px;
  }

  .glass-card,
  .vip-box{
    padding: 8px 10px;
    gap: 6px;
  }

  .rules-list{
    gap: 4px;
  }

  .vip-avatar{
    width: 32px;
    height: 32px;
  }
}

/* 640px: versão bem compacta */
@media (max-width: 640px){
  :root{
    --fs-xs: 9px;
    --fs-sm: 10px;
    --fs-md: 11px;
    --fs-lg: 12px;
    --fs-xl: 16px;
    --fs-2xl: 18px;
  }

  .container{
    max-width: 900px;
  }

  .wrap{
    padding: 6px 8px;
    gap: 6px;
  }

  .glass-card,
  .vip-box{
    padding: 8px 9px;
    border-radius: 18px;
  }

  .loading-bottom{
    gap: 4px;
  }

  .file{
    max-width: 85vw;
  }

  .ttt-subtitle{
    font-size: var(--fs-xs);
  }
}

/* =========================================================
   RESPONSIVIDADE POR ALTURA
   ========================================================= */

/* >>> <=800px de altura -> libera scroll e reduz espaços */
@media (max-height: 800px){
  html, body{
    overflow-y: auto;
    overflow-x: hidden;
  }
  .container{ margin-top: 0; }
  .wrap{
    height: auto;
    min-height: 100vh;
    padding: 8px 10px;
    gap: 8px;
  }
  .top-grid{ gap: 8px; }
  .glass-card{
    min-height: 120px;
    padding: 10px 12px;
  }
  .vip-box{
    min-height: 130px;
    padding: 9px 12px;
  }
  .loading-bar{
    padding: 8px 10px;
    gap: 6px;
  }
  .status{
    white-space: normal;
    max-width: none;
  }
  /* remove o "espaço do meio" quando a altura é baixa */
  .container > div:nth-child(2){ display: none; }
}

/* >>> <=650px de altura (ex: 800x600) -> versão mais compacta */
@media (max-height: 650px){
  .wrap{ padding: 6px 8px; gap: 6px; }
  .top-grid{ gap: 6px; }

  .glass-card, .vip-box{
    min-height: 100px;
    padding: 8px 10px;
  }

  .ttt-header{ font-size: var(--fs-lg); }
  .ttt-subtitle{ font-size: var(--fs-xs); }

  .server-name{
    font-size: clamp(18px, 4vw, 26px);
    letter-spacing: 0.12em;
  }

  .loading-top{ gap: 6px; }
  .loading-bottom{ font-size: var(--fs-xs); }
  .rule-num{ min-width: 30px; min-height: 30px; font-size: clamp(14px, 3vw, 18px); }
}

/* >>> <=520px de altura (stress) */
@media (max-height: 520px){
  .card-vips{ width: 100%; }

  .glass-card, .vip-box{
    min-height: auto;
    gap: 6px;
    padding: 8px 10px;
  }

  .ttt-subtitle{ display:none; }
  .rules-list{ font-size: var(--fs-sm); }
  .vip-card{ padding: 6px 8px; }
  .vip-avatar{ width: 32px; height: 32px; }
}

  </style>
</head>
<body>
  <audio id="bg-music" preload="auto" loop>
    <source src="assets/music/gtavicecity.ogg" type="audio/ogg">
  </audio>

  <!-- background fixo -->
  <div class="bg-layer" id="bg-layer">
    <img id="bg-img" alt="">
  </div>

  <div class="wrap" id="wrap">
    <div class="container">

      <!-- TOP GRID -->
      <div class="top-grid">

        <!-- TTT -->
        <div class="glass-card card-ttt">
          <div class="ttt-header">
            <span class="ttt-badge">TTT</span>
            <span>Trouble in Terrorist Town</span>
          </div>
          <div class="ttt-subtitle">Quem é o assassino?</div>

          <div class="card-scroll ttt-text">
            Em Trouble in Terrorist Town, a paranóia é sua melhor amiga.
            <div class="role-line"><span class="dot dot-red"></span><b>TRAIDORES</b> (Minoria): Matem todos sem serem descobertos.</div>
            <div class="role-line"><span class="dot dot-green"></span><b>INOCENTES</b> (Maioria): Descubram quem são os traidores antes que seja tarde.</div>
            <div class="role-line"><span class="dot dot-blue"></span><b>DETETIVE</b> (Líder): Use ferramentas forenses para caçar os culpados.</div>
            <div class="role-line"><b>Dica:</b> Viu algo suspeito? Avise no chat de voz!</div>
          </div>
        </div>

        <!-- Clube VIP -->
        <div class="glass-card vip-club-card card-vipclub">
          <div class="vip-club-title">Clube VIP</div>
          <div class="card-scroll vip-club-text">
            VIPs têm o privilégio exclusivo de ter o nome estampado na nossa tela de Loading.
          </div>
        </div>

        <!-- Rules -->
        <div class="glass-card card-rules">
          <div class="rules-title">O que você deve saber</div>
          <div class="card-scroll rules-list">
            <div class="rule-item"><div class="rule-num">1</div><div>Não mate sem motivo</div></div>
            <div class="rule-item"><div class="rule-num">2</div><div>Não ofenda nenhum jogador</div></div>
            <div class="rule-item"><div class="rule-num">3</div><div>Não abuse de props</div></div>
            <div class="rule-item"><div class="rule-num">4</div><div>Entre no nosso Discord para estar atualizado, digite <b>!discord</b></div></div>
            <div class="rule-item"><div class="rule-num">5</div><div>Entre no nosso grupo Steam, digite <b>!steam</b></div></div>
          </div>
        </div>

        <!-- VIPs CENTRAL -->
        <div class="vip-box card-vips">
          <div class="vip-head">
            <span class="vip-badge">VIP</span>
            <span class="vip-title">Jogadores do servidor</span>
          </div>
          <div class="vip-list" id="vip-list"></div>
        </div>

      </div>

      <!-- espaço do meio -->
      <div style="min-height:0;"></div>

      <!-- BOTTOM loading + créditos separados -->
      <div class="bottom-area">

        <div class="loading-bar">
          <div class="loading-top">
            <div>
              <div class="server-name" id="server-name">BACKSTABBER BRASIL</div>
              <div class="server-sub" id="server-sub">Conectando ao servidor...</div>
            </div>
            <div class="percent" id="progress-percent">0%</div>
          </div>

          <div class="progress-bg">
            <div class="progress-fill" id="progress-bar"></div>
          </div>

          <div class="loading-bottom">
            <div>
              <div class="status" id="status-text">Aguardando resposta do jogo...</div>
              <div class="file" id="file-text"></div>
            </div>
            <div class="mini-info">
              <div id="info-map">mapa: –</div>
              <div id="info-gamemode">modo: –</div>
            </div>
          </div>
        </div>

        <!-- cardzinho separado -->
        <div class="credits-card">
          Feito por: <b>Sushi</b> e <b>Hanic</b>
        </div>

      </div>

    </div>
  </div>

  <script>
  /* =========================================================
     CONFIG
     ========================================================= */
  var LOADING_CONFIG = {
    fallbackServerName: "Backstabber Brasil",
    subtitleWhenIdle: "Conectando ao servidor...",
    backgroundImages: [
      "https://i.imgur.com/HnZfcKR.jpeg"
    ],
    backgroundChangeSeconds: 12
  };

  var VIPS = [
    {
      steamId: "",
      name: "PigBoyBR",
      avatar: "https://avatars.fastly.steamstatic.com/0986a5f8126b652b332c3f950fcd5f50ce21b410_full.jpg"
    },
{
      steamId: "",
      name: "Mr.B-O-M-B-A-S-T-I-C",
      avatar: "https://shared.akamai.steamstatic.com/community_assets/images/items/2181720/097978e42477d98190ed9e14e971c2b9976fc8d1.gif"
    },
{
      steamId: "",
      name: "Gatogames435",
      avatar: "https://shared.akamai.steamstatic.com/community_assets/images/items/2459330/11bbadea5154c316c883df0f3f1944395b3715b8.gif"
    },
{
      steamId: "",
      name: "Índio Véio",
      avatar: "https://avatars.akamai.steamstatic.com/bf0675b97b1d51792473515563a54b795bd7e0b2_full.jpg"
    },
    {
      steamId: "",
      name: "Luther",
      avatar: "https://avatars.fastly.steamstatic.com/5567b97dc8ce131d5f8cf4d885d632d1f325fcc5_full.jpg"
    },
    {
      steamId: "",
      name: "paçoquita",
      avatar: "https://shared.fastly.steamstatic.com/community_assets/images/items/2598440/5bdec92696b30d8b1a7dd8e00e1af4ec4ddc9013.gif"
    },
    {
      steamId: "",
      name: "tutuzinhorod",
      avatar: "https://avatars.fastly.steamstatic.com/0b7e2573fada1ef30de1e09e2a9c032c1ed212fc_full.jpg"
    }

    // adicione mais VIPs aqui
  ];

  /* =========================================================
     BACKGROUND FIXO (cover total)
     ========================================================= */
  (function initBackground(){
    var layer = document.getElementById("bg-layer");
    if(!layer) return;
    if(!LOADING_CONFIG.backgroundImages || LOADING_CONFIG.backgroundImages.length === 0) return;

    var url = LOADING_CONFIG.backgroundImages[0];

    // >>> SETA IMEDIATO (garante no CEF)
    layer.style.backgroundImage = "url('" + url + "')";

    // preload opcional só pra evitar flash quando trocar depois
    var pre = new Image();
    pre.src = url;
  })();

  /* =========================================================
     VIP RENDER + AJUSTE DE LARGURA DO CARD
     ========================================================= */
  function renderVips(){
    var list = document.getElementById("vip-list");
    if(!list) return;
    list.innerHTML = "";

    // monta os cards
    for(var i=0; i<VIPS.length; i++){
      var v = VIPS[i];
      var card = document.createElement("div");
      card.className = "vip-card";
      card.innerHTML =
        '<img class="vip-avatar" src="'+v.avatar+'" alt="'+v.name+'">' +
        '<div>' +
          '<div class="vip-name rainbow-text">'+v.name+'</div>' +
          '<div class="vip-id">'+(v.steamId||"")+'</div>' +
        '</div>';
      list.appendChild(card);
    }

    // ajusta o tamanho / posição do card de VIP conforme quantidade
    var box = document.querySelector(".card-vips");
    if(box){
      var count = VIPS.length;
      var cols = Math.ceil(count / 4) || 1;  // 4 por coluna

      if(cols <= 1){
        // até 4 VIPs -> ocupa só a coluna do meio (mesma largura dos outros)
        box.style.gridColumn = "2 / span 1";
        box.style.maxWidth  = "100%";
        box.style.margin    = "0";
      } else if(cols === 2){
        // 5–8 VIPs -> visualmente 2 colunas, mas CENTRALIZADO
        // ocupa a linha inteira no grid e limita a largura a ~2/3
        box.style.gridColumn = "1 / span 3";
        box.style.maxWidth   = "66.666%";
        box.style.margin     = "0 auto";
      } else {
        // 9+ VIPs -> ocupa as 3 colunas (triplo, linha toda)
        box.style.gridColumn = "1 / span 3";
        box.style.maxWidth   = "100%";
        box.style.margin     = "0";
      }
    }
  }
  renderVips();

  /* =========================================================
     MÚSICA DE FUNDO
     ========================================================= */
  (function initMusic(){
    var audio = document.getElementById("bg-music");
    if(!audio) return;

    audio.volume = 0.25;

    function tryPlay(){
      try {
        var p = audio.play();
        if(p && typeof p.catch === "function"){
          p.catch(function(){});
        }
      } catch(e){}
    }

    var ua = navigator.userAgent || "";
    if(ua.indexOf("GMod") !== -1){
      tryPlay();
    } else {
      window.addEventListener("click", tryPlay, { once:true });
      window.addEventListener("keydown", tryPlay, { once:true });
    }
  })();

  /* =========================================================
     PROGRESSO / STATUS
     ========================================================= */
  var currentProgress = 0;
  var mountingAddons = false;

  function setProgress(target){
    if(target < 0) target = 0;
    if(target > 100) target = 100;
    if(target < currentProgress) target = currentProgress;
    currentProgress = target;

    document.getElementById("progress-bar").style.width = target + "%";
    document.getElementById("progress-percent").textContent = Math.round(target) + "%";

    if(target >= 99){
      document.getElementById("server-sub").textContent = "Pronto para entrar!";
    }
  }

  /* =========================================================
     HOOKS DO GMOD
     ========================================================= */
  function GameDetails(servername, serverurl, mapname, maxplayers, steamid, gamemode){
    document.getElementById("server-name").textContent =
      servername || LOADING_CONFIG.fallbackServerName;

    document.getElementById("server-sub").textContent =
      LOADING_CONFIG.subtitleWhenIdle;

    document.getElementById("info-map").textContent =
      "mapa: " + (mapname || "–");

    document.getElementById("info-gamemode").textContent =
      "modo: " + (gamemode || "–");

  }

  function SetStatusChanged(status){
    document.getElementById("status-text").textContent = status || "";

    if(status && status.indexOf("/") !== -1){
      var match = status.match(/(\d+)\s*\/\s*(\d+)/);
      if(match){
        var cur = parseInt(match[1],10) || 0;
        var tot = parseInt(match[2],10) || 1;
        var base = mountingAddons ? 40 : 10;
        var pct = base + (cur/tot)*60;
        setProgress(pct);
      }
    }

    if(status === "Mounting Addons" || status === "Workshop Complete"){
      mountingAddons = true;
      setProgress(80);
    }
    if(status === "Client info sent!" || status === "Client info sent"){
      setProgress(92);
    }
    if(status === "Starting Lua..."){
      setProgress(100);
    }
  }

  function DownloadingFile(fileName){
    document.getElementById("file-text").textContent =
      fileName ? "Baixando: " + fileName : "";
  }

  window.GameDetails = GameDetails;
  window.SetStatusChanged = SetStatusChanged;
  window.DownloadingFile = DownloadingFile;

  /* =========================================================
     AUTO SCALE
     ========================================================= */
  (function autoScale(){
    function apply(){
      var w = window.innerWidth;
      var h = window.innerHeight;
      var scaleW = w / 1920;
      var scaleH = h / 1080;
      var s = Math.min(scaleW, scaleH);
      s = Math.max(0.7, Math.min(1.18, s));
      document.documentElement.style.setProperty("--ui-scale", s.toFixed(3));
    }
    apply();
    window.addEventListener("resize", apply);
  })();

  /* =========================================================
     PREVIEW FORA DO GMOD
     ========================================================= */
  (function preview(){
    var ua = navigator.userAgent || "";
    if(ua.indexOf("GMod") !== -1) return;

    GameDetails(
      LOADING_CONFIG.fallbackServerName,
      "", "ttt_minecraft_b5", 24, "", "Trouble in Terrorist Town"
    );

    var steps = [
      "Conectando ao servidor...",
      "Autenticando...",
      "3/20","7/20","14/20","20/20",
      "Workshop Complete",
      "Client info sent!",
      "Starting Lua..."
    ];

    var i=0;
    function tick(){
      if(i>=steps.length) return;
      SetStatusChanged(steps[i++]);
      setTimeout(tick, 900);
    }
    setTimeout(tick, 800);
  })();

  (function initBackgroundImg(){
    var imgEl = document.getElementById("bg-img");
    if(!imgEl) return;

    var ABS_BG = "https://hanicbr.github.io/backtttloading/assets/bg.png";

    var pre = new Image();
    pre.onload = function(){
      imgEl.src = ABS_BG;
    };
    pre.onerror = function(){
      // fallback opcional
    };

    pre.src = ABS_BG + (ABS_BG.indexOf("?") === -1 ? "?" : "&") + "v=" + Date.now();
  })();
  </script>
</body>
</html>
